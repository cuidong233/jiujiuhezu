import{p as V,f as M,h as w,r as d,c as y,a,i as C,d as l,t as b,F as E,l as S,j as P,v as T,s as L,o,n as A,_ as D,u as R,g as O,b as B,H as F,m as x,z as U,E as z,x as H,L as I}from"./EcDhdyxl.js";import{_ as j,a as q}from"./BKRz7CiX.js";import{P as K}from"./CEhaGLKI.js";import"./Dw_Z4xcU.js";import"./C0puMdAJ.js";const X=V("/images/yue.png"),Z={class:"modal-mask"},G={class:"balance-modal"},J={class:"modal-header"},Q={class:"modal-content"},W={class:"main-tip"},Y={class:"need-amount"},aa={class:"amount-row-card2"},sa={class:"amount-block-card2"},ta={class:"amount-value"},ea={class:"amount-block-card2"},ca={class:"amount-value need"},da={class:"amount-diff"},na={class:"recharge-section-card2"},ia={class:"recharge-options-card2"},la=["onClick"],oa={class:"recharge-main"},va={class:"recharge-desc"},ba={class:"recharge-input-row"},ra={class:"modal-actions-card"},ua=M({__name:"BalanceNotEnoughModal",props:{balance:{type:Number,default:0},needAmount:{type:Number,default:0},options:{type:Array,default:()=>[{value:50,desc:"无优惠"},{value:100,desc:"送￥20"},{value:200,desc:"送￥50"},{value:500,desc:"送￥150"}]}},setup(r){const h=r,u=w(()=>Math.max(h.needAmount-h.balance,0)),i=d(1),v=d(null),_=L();function e(f){i.value=f,v.value=null}function p(){i.value=-1}function m(){_.push("/profile/wallet")}return(f,s)=>(o(),y("div",Z,[a("div",G,[a("div",J,[s[4]||(s[4]=a("div",{class:"modal-title"},"余额不足",-1)),s[5]||(s[5]=a("div",{class:"modal-subtitle"},"您的账户余额不足以完成当前操作",-1)),a("button",{class:"modal-close",onClick:s[0]||(s[0]=c=>f.$emit("close"))},"×")]),a("div",Q,[s[14]||(s[14]=C('<div class="warn-icon-box" data-v-680eb8e3><svg class="warn-icon" viewBox="0 0 80 80" fill="none" data-v-680eb8e3><path d="M40 12L72 68H8L40 12Z" fill="#FF5B5B" data-v-680eb8e3></path><rect x="37" y="36" width="6" height="18" rx="3" fill="#fff" data-v-680eb8e3></rect><rect x="37" y="58" width="6" height="6" rx="3" fill="#fff" data-v-680eb8e3></rect></svg></div>',1)),a("div",W,[s[6]||(s[6]=l(" 当前操作需要")),a("span",Y,"￥"+b(r.needAmount.toFixed(2)),1),s[7]||(s[7]=l("，但您的账户余额不足，")),s[8]||(s[8]=a("br",null,null,-1)),s[9]||(s[9]=l("请充值后再继续操作 "))]),a("div",aa,[a("div",sa,[s[10]||(s[10]=a("div",{class:"amount-label"},"当前账户余额",-1)),a("div",ta,"￥"+b(r.balance.toFixed(2)),1)]),a("div",ea,[s[12]||(s[12]=a("div",{class:"amount-label"},"需要金额",-1)),a("div",ca,"￥"+b(r.needAmount.toFixed(2)),1),a("div",da,[s[11]||(s[11]=l("差额: ")),a("span",null,"￥"+b(u.value.toFixed(2)),1)])])]),a("div",na,[s[13]||(s[13]=a("div",{class:"recharge-title"},"请选择充值金额",-1)),a("div",ia,[(o(!0),y(E,null,S(r.options,(c,k)=>(o(),y("div",{key:c.value,class:A(["recharge-option-card2",{active:i.value===k}]),onClick:N=>e(k)},[a("div",oa,"￥"+b(c.value),1),a("div",va,b(c.desc),1)],10,la))),128))]),a("div",ba,[P(a("input",{"onUpdate:modelValue":s[1]||(s[1]=c=>v.value=c),type:"number",min:"1",placeholder:"输入其他金额",onFocus:s[2]||(s[2]=c=>i.value=-1)},null,544),[[T,v.value,void 0,{number:!0}]]),a("button",{class:"input-confirm-card2",onClick:p},"确定")])])]),a("div",ra,[a("button",{class:"btn-cancel-card",onClick:s[3]||(s[3]=c=>f.$emit("close"))},"取消"),a("button",{class:"btn-confirm-card",onClick:m},s[15]||(s[15]=[a("img",{src:X,alt:"余额充值",style:{width:"20px",height:"20px","margin-right":"6px","vertical-align":"middle"}},null,-1),l(" 前往钱包充值 ")]))]),s[16]||(s[16]=a("div",{class:"modal-tip-card"},[l(" 充值金额即时到账，可用于平台所有消费 "),a("a",{href:"#",class:"recharge-link"},"查看充值说明")],-1))])]))}}),pa=D(ua,[["__scopeId","data-v-680eb8e3"]]),ma={class:"checkout-page"},ya={class:"checkout-content"},fa={class:"checkout-container"},ga={class:"order-summary"},ha={class:"summary-card"},ka={class:"pay-methods"},xa={key:0,class:"check"},wa={key:0,class:"check"},_a={class:"summary-actions"},$a=M({__name:"checkout",setup(r){const h=L(),u=R(),i=d(!1),v=d(!1),_=d(0),e=d("balance"),p=d([]);d([]),d([]);const m=d(null);O(async()=>{var t;if(!u.isLoggedIn){z.warning("请先登录后再结算"),h.push("/");return}const n=await H.getCartList(((t=u.user)==null?void 0:t.id)||1);n&&n.data&&(p.value=n.data)});const s=w(()=>p.value.reduce((n,t)=>n+t.price*t.quantity,0)),c=w(()=>m.value?m.value.amount:0),k=w(()=>s.value-c.value);function N(){var n,t,g;if(e.value==="balance"){if((((n=u.user)==null?void 0:n.balance)??0)<k.value){i.value=!0;return}I.createOrder({items:p.value,payType:"balance",couponId:(t=m.value)==null?void 0:t.id}).then(()=>{v.value=!0})}else I.createOrder({items:p.value,payType:"alipay",couponId:(g=m.value)==null?void 0:g.id}).then(()=>{v.value=!0})}return(n,t)=>{var g;return o(),y("div",ma,[B(j),a("div",ya,[a("div",fa,[t[11]||(t[11]=C('<div class="order-info" data-v-2bb57c7c><div class="order-card" data-v-2bb57c7c><div class="order-header" data-v-2bb57c7c><img src="https://via.placeholder.com/64x64?text=N" class="order-logo" data-v-2bb57c7c><div class="order-header-main" data-v-2bb57c7c><div class="order-title-row" data-v-2bb57c7c><span class="brand" data-v-2bb57c7c>NETFLIX</span><span class="price-tag" data-v-2bb57c7c>￥29/月</span></div><div class="order-meta" data-v-2bb57c7c><span data-v-2bb57c7c>商品属性：Netflix一个月</span><span data-v-2bb57c7c>订单号：1471461548159010</span></div></div></div><div class="order-divider" data-v-2bb57c7c></div><div class="section-title" data-v-2bb57c7c>核对您的套餐</div><div class="plan-main" data-v-2bb57c7c><div class="plan-box" data-v-2bb57c7c><div class="plan-title" data-v-2bb57c7c>月付套餐</div><div class="plan-features" data-v-2bb57c7c><div data-v-2bb57c7c>基础清晰度（720p）</div><div data-v-2bb57c7c>无广告体验</div><div data-v-2bb57c7c>1台设备同时观看</div><div data-v-2bb57c7c>每月自动续订</div></div></div><div class="plan-options" data-v-2bb57c7c><div class="option-group" data-v-2bb57c7c><div class="option-title" data-v-2bb57c7c>地区选择</div><div class="option-list" data-v-2bb57c7c><label data-v-2bb57c7c><input type="checkbox" data-v-2bb57c7c> 美国（内容最全）</label><label data-v-2bb57c7c><input type="checkbox" data-v-2bb57c7c> 英国（更新最快）</label><label data-v-2bb57c7c><input type="checkbox" data-v-2bb57c7c> 日本（动漫最多）</label></div></div><div class="option-group" data-v-2bb57c7c><div class="option-title" data-v-2bb57c7c>清晰度选择</div><div class="option-list" data-v-2bb57c7c><label data-v-2bb57c7c><input type="checkbox" data-v-2bb57c7c> 高清（1080p）</label><label data-v-2bb57c7c><input type="checkbox" data-v-2bb57c7c> 超高清（4K）</label></div></div></div></div><div class="section-title" style="margin-top:32px;" data-v-2bb57c7c>Disney+ 年度订阅</div><div class="disney-section" data-v-2bb57c7c><img src="https://via.placeholder.com/100x100?text=Disney+" class="disney-img" data-v-2bb57c7c><div class="disney-info" data-v-2bb57c7c><div class="disney-price-row" data-v-2bb57c7c><span class="disney-title" data-v-2bb57c7c>￥180</span><span class="disney-discount" data-v-2bb57c7c>立减￥10</span></div><div class="disney-desc" data-v-2bb57c7c>海量迪士尼、皮克斯、漫威、星球大战和国家地理内容</div><button class="disney-btn" data-v-2bb57c7c>加购</button></div></div></div></div>',1)),a("div",ga,[a("div",ha,[t[9]||(t[9]=C('<div class="summary-title" data-v-2bb57c7c>价格明细</div><div class="summary-list" data-v-2bb57c7c><div class="summary-row" data-v-2bb57c7c><span data-v-2bb57c7c>Netflix 月付</span><span data-v-2bb57c7c>￥29</span></div><div class="summary-row" data-v-2bb57c7c><span data-v-2bb57c7c>Netflix 月付加购</span><span data-v-2bb57c7c>￥29</span></div><div class="summary-row" data-v-2bb57c7c><span data-v-2bb57c7c>Disney+ 年度订阅</span><span data-v-2bb57c7c>￥0</span></div><div class="summary-row" data-v-2bb57c7c><span data-v-2bb57c7c>折扣</span><span class="discount" data-v-2bb57c7c>-￥0</span></div><div class="summary-row total" data-v-2bb57c7c><span data-v-2bb57c7c>合计</span><span class="total-price" data-v-2bb57c7c>￥58</span></div></div><div class="coupon-row" data-v-2bb57c7c><input class="coupon-input" placeholder="点击输入优惠码" data-v-2bb57c7c><button class="coupon-btn" data-v-2bb57c7c>应用</button></div><div class="coupon-tip" data-v-2bb57c7c>输入优惠码可享受额外折扣</div>',4)),a("div",ka,[a("div",{class:A(["pay-method",{selected:e.value==="balance"}]),onClick:t[0]||(t[0]=$=>e.value="balance")},[t[3]||(t[3]=a("span",{class:"pay-icon"},"🎫",-1)),t[4]||(t[4]=l(" 余额支付 ")),e.value==="balance"?(o(),y("span",xa,"✔")):x("",!0)],2),a("div",{class:A(["pay-method",{selected:e.value==="alipay"}]),onClick:t[1]||(t[1]=$=>e.value="alipay")},[t[5]||(t[5]=a("span",{class:"pay-icon"},"💳",-1)),t[6]||(t[6]=l(" 支付宝支付 ")),e.value==="alipay"?(o(),y("span",wa,"✔")):x("",!0)],2)]),t[10]||(t[10]=a("div",{class:"privacy-tip"},"隐私政策/用户协议遵照政策",-1)),a("div",_a,[t[7]||(t[7]=a("button",{class:"gift-btn"},"购买后赠送AI体验卡（价值￥99）",-1)),a("button",{class:"pay-btn",onClick:N},b(e.value==="balance"?"余额支付":"支付宝支付"),1),t[8]||(t[8]=a("div",{class:"pay-tip"},"*点击支付即表示您同意我们的服务协议和隐私政策",-1))])])])])]),B(q),i.value?(o(),F(pa,{key:0,balance:((g=U(u).user)==null?void 0:g.balance)??0,needAmount:_.value,onClose:t[2]||(t[2]=$=>i.value=!1)},null,8,["balance","needAmount"])):x("",!0),v.value?(o(),F(K,{key:1})):x("",!0)])}}}),Ia=D($a,[["__scopeId","data-v-2bb57c7c"]]);export{Ia as default};
