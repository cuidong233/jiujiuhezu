import{_,a as f}from"./BKRz7CiX.js";import{f as h,r,X as k,g as y,c as d,b as v,a,m as x,t as n,d as T,o as p,_ as I}from"./EcDhdyxl.js";import"./Dw_Z4xcU.js";const b={class:"goods-detail-page"},C={class:"debug-info"},N={key:0,class:"goods-content"},w={key:1,class:"loading"},A={key:2,class:"error"},V=h({__name:"[id]-simple",setup($){const g=k(),t=r(g.params.id),l=r(!0),i=r(""),s=r(null);async function m(){console.log("开始加载商品，ID:",t.value),l.value=!0,i.value="";const c=setTimeout(()=>{console.log("加载超时，使用模拟数据"),s.value={id:t.value,name:"超时商品 "+t.value,price:77.77,desc:"加载超时，显示默认数据",image:"/images/xiangqingzhutu1.png"},l.value=!1,i.value="加载超时"},3e3);try{const o=`http://localhost:3001/api/product/goods/${t.value}`;console.log("请求URL:",o);const u=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json"}});if(clearTimeout(c),!u.ok)throw new Error(`HTTP error! status: ${u.status}`);const e=await u.json();console.log("API响应:",e),e.success&&e.data?s.value={id:e.data.id,name:e.data.title||e.data.name,price:e.data.price,desc:e.data.description,image:e.data.image}:s.value={id:t.value,name:"测试商品 "+t.value,price:99.99,desc:"这是一个测试商品",image:"/images/xiangqingzhutu1.png"}}catch(o){clearTimeout(c),console.error("加载失败:",o),i.value=o.message||"加载失败",s.value={id:t.value,name:"模拟商品 "+t.value,price:88.88,desc:"API加载失败，显示模拟数据",image:"/images/xiangqingzhutu1.png"}}finally{l.value=!1}}return y(()=>{console.log("页面挂载完成，准备加载数据"),m()}),(c,o)=>{const u=_,e=f;return p(),d("div",b,[v(u),a("div",C,[o[1]||(o[1]=a("h3",null,"调试信息",-1)),a("p",null,"商品ID: "+n(t.value),1),a("p",null,"加载状态: "+n(l.value?"正在加载":"加载完成"),1),a("p",null,"错误信息: "+n(i.value||"无"),1),a("p",null,"数据: "+n(JSON.stringify(s.value,null,2)),1)]),!l.value&&s.value?(p(),d("div",N,[a("h1",null,n(s.value.name),1),a("p",null,"价格: ¥"+n(s.value.price),1),a("p",null,"描述: "+n(s.value.desc),1),a("button",{onClick:o[0]||(o[0]=q=>c.$router.back())},"返回")])):l.value?(p(),d("div",w," 正在加载商品信息... ")):i.value?(p(),d("div",A,[T(" 加载失败: "+n(i.value)+" ",1),a("button",{onClick:m},"重试")])):x("",!0),v(e)])}}}),E=I(V,[["__scopeId","data-v-a4ef45a7"]]);export{E as default};
