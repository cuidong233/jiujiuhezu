import{f as A,r as g,B as Z,g as B,C as tt,c,a as e,m as $,b as k,w as M,T as V,F as x,l as w,D as et,o as n,n as T,_ as L,u as st,G as Q,h as G,H as O,I as at,J as z,$ as nt,t as b,i as H,K as ot,s as it,L as ct,q as P}from"./EcDhdyxl.js";import{b as rt,g as lt,_ as dt,a as ut}from"./BKRz7CiX.js";import{_ as pt,a as _t,b as vt}from"./rcMrI-Ly.js";import{O as ht}from"./BD1EBftG.js";import{u as bt}from"./Bc9UkeLm.js";import"./Dw_Z4xcU.js";import"./DcjaKIUg.js";import"./CEhaGLKI.js";import"./C0puMdAJ.js";const mt={class:"banner-section"},gt={class:"banner-inner"},ft={class:"banner-slider"},yt=["src","alt"],kt={key:0,class:"banner-indicators"},$t=["onClick"],xt={key:1,class:"banner-controls"},wt=A({__name:"BannerSection",props:{banners:{}},setup(C){const p=C,l=g(0);let _=null;const o=()=>{d(),p.banners.length>1&&(_=et(()=>{i()},5e3))},d=()=>{_&&(clearInterval(_),_=null)},i=()=>{l.value=(l.value+1)%p.banners.length},v=()=>{l.value=l.value===0?p.banners.length-1:l.value-1},m=u=>{l.value=u,o()};return Z(()=>p.banners,()=>{l.value=0,o()}),B(()=>{o()}),tt(()=>{d()}),(u,I)=>(n(),c("section",mt,[e("div",gt,[e("div",ft,[k(V,{name:"fade",mode:"out-in"},{default:M(()=>[u.banners.length>0?(n(),c("div",{key:l.value,class:"banner-item"},[e("img",{src:u.banners[l.value].image,alt:u.banners[l.value].title,class:"banner-image"},null,8,yt)])):$("",!0)]),_:1})]),u.banners.length>1?(n(),c("div",kt,[(n(!0),c(x,null,w(u.banners,(N,S)=>(n(),c("span",{key:S,class:T(["indicator",{active:S===l.value}]),onClick:R=>m(S)},null,10,$t))),128))])):$("",!0),u.banners.length>1?(n(),c("div",xt,[e("button",{class:"control-btn prev",onClick:v},"‹"),e("button",{class:"control-btn next",onClick:i},"›")])):$("",!0)])]))}}),Ct=L(wt,[["__scopeId","data-v-c0cb12e6"]]),It={class:"goods-section"},St={class:"goods-inner"},Dt={class:"goods-tabs-wrap"},At={class:"goods-tabs"},Lt=["onClick"],qt={class:"tab-label"},Tt={class:"goods-grid"},Bt=["onClick"],Nt={key:0,class:"goods-hot-tag"},Ft={class:"goods-default-layout"},Kt={class:"goods-image special-image"},Pt=["src","alt"],Rt={class:"goods-info"},Gt={class:"goods-title-row2"},Ot={class:"goods-name2"},zt={class:"goods-meta2"},Ht={class:"goods-price2"},Mt={class:"goods-price-unit"},Vt={class:"goods-sales-row2"},Qt={class:"goods-features2 special-features"},Et={key:0,class:"goods-feature2"},Jt={key:0,class:"goods-promo2 special-promo"},Ut={key:0,class:"discount-badge"},Xt={class:"discount-text"},jt={class:"goods-hover-layout"},Wt={class:"hover-header"},Yt={class:"hover-app-icon"},Zt=["src","alt"],te={class:"hover-app-info"},ee={class:"hover-app-name"},se={class:"hover-price-section"},ae={class:"hover-price-number"},ne={class:"hover-price-unit"},oe={class:"hover-stats"},ie={class:"hover-sales"},ce={class:"hover-features"},re={key:0,class:"hover-feature-tag"},le={class:"hover-buy-section"},de=["onClick"],ue=900,pe=A({__name:"GoodsSection",props:{goodsList:{}},setup(C){const p=C,l=st(),_=Q(),o=g(null),d=[{key:"all",label:"全部",categoryId:null},{key:"video",label:"视频音乐",categoryId:3},{key:"vtuber",label:"Vtuber",categoryId:4},{key:"recharge",label:"代充代付",categoryId:8},{key:"game",label:"游戏",categoryId:9},{key:"card",label:"卡券",categoryId:10},{key:"welfare",label:"福利社",categoryId:11}],i=g("all");function v(t){i.value=t,z(N)}const m=G(()=>d.findIndex(t=>t.key===i.value)),u=g([]),I=g({left:"0px",width:"120px"});function N(){z(()=>{const t=m.value,s=u.value&&u.value.length>t?u.value[t]:null;if(s){const r=s.querySelector(".tab-icon");if(r){const a=s.parentElement.getBoundingClientRect(),h=r.getBoundingClientRect();I.value={left:`${h.left-a.left}px`,width:`${h.width}px`}}}})}const S=async()=>{try{const t=window.location.hostname==="localhost"?"http://localhost:3002":"",s=await nt(`${t}/api/discount/active`);s.success&&s.data&&(o.value=s.data,console.log("当前活动折扣:",o.value))}catch(t){console.error("获取折扣活动失败:",t)}};B(()=>{N(),S()});const R=G(()=>{const t=d.find(s=>s.key===i.value);return!t||t.categoryId===null?p.goodsList:p.goodsList.filter(s=>Number(s.categoryId||s.categoryCode)===t.categoryId)}),q=t=>{var r,a;if(t.attributes&&t.attributes.tags){if(typeof t.attributes.tags=="string")try{return JSON.parse(t.attributes.tags)}catch{return t.attributes.tags.split(",").map(h=>h.trim())}if(Array.isArray(t.attributes.tags))return t.attributes.tags}if(typeof t.attributes=="string")try{const h=JSON.parse(t.attributes);if(h.tags){if(Array.isArray(h.tags))return h.tags;if(typeof h.tags=="string")return h.tags.split(",").map(f=>f.trim())}}catch{}if(t.tags){if(Array.isArray(t.tags))return t.tags;if(typeof t.tags=="string")return t.tags.split(",").map(h=>h.trim())}const s=[];return(t.quality==="4K"||(r=t.name)!=null&&r.includes("4K"))&&s.push("4K高清"),(t.region==="全球"||(a=t.name)!=null&&a.includes("全球"))&&s.push("全球解锁"),(t.duration==="月"||t.duration==="1个月")&&s.push("单月起售"),s.slice(0,4)},E=t=>t.includes("全球")||t.includes("解锁")?"feature-global":t.includes("4K")||t.includes("高清")?"feature-4k":t.includes("杜比")||t.includes("音效")?"feature-dolby":t.includes("月")||t.includes("起售")?"feature-monthly":"",F=t=>{if(t.min_sku_price!==void 0&&t.min_sku_price!==null)return t.min_sku_price;if(t.skus&&Array.isArray(t.skus)&&t.skus.length>0){const s=t.skus.filter(r=>r.status===1&&r.stock>0);if(s.length>0)return s.sort((a,h)=>parseFloat(a.price)-parseFloat(h.price))[0].price}return t.min_price!==void 0&&t.min_price!==null?t.min_price:t.price||"0.00"},D=g(!1),y=g(null),J=async t=>{if(!l.isLoggedIn){console.log("🔐 用户未登录，打开登录弹窗"),_.openLogin();return}console.log("💳 用户已登录，准备创建订单"),console.log("🛍️ 商品数据:",t),console.log("🔑 可用的商品编码字段:",{goods_code:t.goods_code,code:t.code,unicode:t.unicode,id:t.id});try{const s={unicode:t.goods_code||t.code||t.unicode||String(t.id),quantity:1,price:F(t)};console.log("📝 创建订单参数:",s);const r=await ct.createOrder(s);r.success&&r.data?(console.log("✅ 订单创建成功:",r.data),y.value={...t,orderId:r.data.orderNo||r.data.id,shopLogo:t.logo||"/images/shop-logo.png",shopName:t.shopName||"某旗舰店",shopDesc:t.shopDesc||""},D.value=!0):(console.error("❌ 创建订单失败:",r),alert(r.msg||"创建订单失败，请重试"))}catch(s){console.error("❌ 创建订单异常:",s),alert("创建订单失败，请重试")}};function U(){D.value=!1}const X=it(),j=t=>{X.push(`/goods/${t.id}`)},W=()=>o.value?o.value.discount_type==="percentage"?`限时${o.value.discount_value/10}折`:`立减¥${o.value.discount_value}`:"",Y=t=>{var s,r;console.log("🛒 商品列表页支付成功！",t),alert(`🎉 支付成功！
商品：${((s=y.value)==null?void 0:s.name)||((r=y.value)==null?void 0:r.title)}
订单号：${t.orderId}
金额：¥${t.amount}`),D.value=!1};return(t,s)=>{const r=rt;return n(),c("section",It,[e("div",St,[e("div",Dt,[e("div",At,[(n(),c(x,null,w(d,(a,h)=>e("div",{key:a.key,class:T(["goods-tab",{active:a.key===i.value}]),onClick:f=>v(a.key)},[s[1]||(s[1]=e("div",{class:"tab-icon"},null,-1)),e("div",qt,b(a.label),1)],10,Lt)),64))]),e("div",{class:"tab-underline",style:at(I.value)},null,4)]),e("div",Tt,[(n(!0),c(x,null,w(R.value,(a,h)=>(n(),c("div",{key:a.id,class:"goods-card",onClick:f=>j(a),style:{cursor:"pointer"}},[a.status===1?(n(),c("div",Nt,"热卖")):$("",!0),e("div",Ft,[e("div",Kt,[e("img",{src:a.image||"/images/netflix.png",alt:a.name,class:"special-img"},null,8,Pt)]),e("div",Rt,[e("div",Gt,[e("span",Ot,b(a.name),1),s[2]||(s[2]=H('<span class="goods-recent" data-v-b90ba080>🕒 XX分钟前购买过</span><span class="goods-help" data-v-b90ba080><svg width="16" height="16" viewBox="0 0 16 16" fill="none" data-v-b90ba080><circle cx="8" cy="8" r="8" fill="#EDF3FF" data-v-b90ba080></circle><text x="8" y="12" text-anchor="middle" font-size="12" fill="#235CDC" data-v-b90ba080>?</text></svg></span>',2))]),e("div",zt,[s[3]||(s[3]=e("span",{class:"goods-price-label"},"券后",-1)),e("span",Ht,b(F(a)),1),e("span",Mt,"/"+b(a.add_unit||"12个月"),1)]),e("div",Vt,[e("span",null,"销量: "+b(a.sales||"2.5万+"),1),s[4]||(s[4]=e("span",null,"好评: 98%",-1))]),e("div",Qt,[(n(!0),c(x,null,w(q(a),(f,K)=>(n(),c("span",{key:K,class:"goods-feature2"},b(f),1))),128)),q(a).length?$("",!0):(n(),c("span",Et,"热销商品"))]),(n(),c("div",Jt,[o.value?(n(),c("div",Ut,[e("span",Xt,b(W()),1)])):(n(),O(r,{key:1,src:"/images/cut.png",alt:"限时优惠",title:"限时优惠",width:60,height:20,loading:"lazy",class:"cut-img"}))]))])]),e("div",jt,[e("div",Wt,[e("div",Yt,[e("img",{src:a.image||"/images/netflix.png",alt:a.name||a.title,class:"hover-icon-img"},null,8,Zt)])]),e("div",te,[e("div",ee,b(a.name||a.title),1),s[5]||(s[5]=H('<div class="hover-app-meta" data-v-b90ba080><div class="hover-user-avatars" data-v-b90ba080><img src="'+pt+'" alt="用户1" class="hover-avatar" data-v-b90ba080><img src="'+_t+'" alt="用户2" class="hover-avatar" data-v-b90ba080><img src="'+vt+'" alt="用户3" class="hover-avatar" data-v-b90ba080></div><span class="hover-purchased-text" data-v-b90ba080>谁购买过</span><div class="hover-verified-icon" data-v-b90ba080><svg width="20" height="20" viewBox="0 0 20 20" fill="none" data-v-b90ba080><circle cx="10" cy="10" r="10" fill="#235CDC" data-v-b90ba080></circle><text x="10" y="14" text-anchor="middle" font-size="12" fill="white" data-v-b90ba080>?</text></svg></div></div>',1))]),e("div",se,[s[6]||(s[6]=e("span",{class:"hover-price-label"},"券后",-1)),e("span",ae,b(F(a)),1),e("span",ne,"/"+b(a.add_unit||"12个月"),1)]),e("div",oe,[e("span",ie,"销量: "+b(a.sales||"2.5万+"),1),s[7]||(s[7]=e("span",{class:"hover-rating"},"好评: 98%",-1))]),e("div",ce,[(n(!0),c(x,null,w(q(a),(f,K)=>(n(),c("span",{key:K,class:T(["hover-feature-tag",E(f)])},b(f),3))),128)),q(a).length?$("",!0):(n(),c("span",re,"热销商品"))]),e("div",le,[e("button",{class:"hover-buy-btn",onClick:ot(f=>J(a),["stop"])},"购买",8,de)])])],8,Bt))),128))])]),D.value?(n(),O(ht,{key:0,shopLogo:y.value.shopLogo,shopName:y.value.shopName,shopDesc:y.value.shopDesc,orderId:y.value.orderId,price:y.value.price,countdown:ue,onClose:s[0]||(s[0]=a=>D.value=!1),onTimeout:U,onPaySuccess:Y},null,8,["shopLogo","shopName","shopDesc","orderId","price"])):$("",!0)])}}}),_e=L(pe,[["__scopeId","data-v-b90ba080"]]),ve={class:"faq-section"},he={class:"faq-container"},be={class:"faq-grid"},me=["onClick"],ge={class:"question-text"},fe={key:0,class:"faq-answer"},ye=A({__name:"FaqSection",setup(C){const p=g([]),l=g([{id:1,title:"如何购买商品？",content:"选择您需要的商品，点击购买按钮，选择支付方式完成支付即可。支付成功后，系统会自动发送CDK到您的邮箱或账户中。"},{id:2,title:"支付后多久能收到CDK？",content:'支付成功后，系统会立即自动发货，您可以在"我的订单"中查看CDK信息。如遇特殊情况，请联系在线客服处理。'},{id:3,title:"支持哪些支付方式？",content:"我们支持支付宝、微信支付、银行卡等多种支付方式，您可以选择最方便的方式进行支付。"},{id:4,title:"CDK如何使用？",content:"获得CDK后，请在对应平台的兑换页面输入CDK码进行兑换。具体操作步骤请参考商品详情页的使用说明。"},{id:5,title:"可以退款吗？",content:"虚拟商品一经售出，如无质量问题不支持退款。如遇到CDK无法使用等问题，请及时联系客服，我们会为您处理。"},{id:6,title:"如何联系客服？",content:'您可以点击页面右下角的客服按钮，或在导航栏点击"客服"进入在线客服系统，我们的客服团队会及时为您解答。'}]),_=d=>{const i=p.value.indexOf(d);i>-1?p.value.splice(i,1):p.value.push(d)},o=async()=>{var d,i;try{const v=await((i=(d=P).getHotQuestions)==null?void 0:i.call(d))||await P.getQuestionList();if(v&&v.data){const m=Array.isArray(v.data)?v.data:v.data.list||[];m.length>0&&(l.value=m.slice(0,6).map(u=>({id:u.id,title:u.title,content:u.content||u.answer})))}}catch{console.log("使用默认FAQ数据")}};return B(()=>{o()}),(d,i)=>(n(),c("section",ve,[e("div",he,[i[1]||(i[1]=e("div",{class:"section-header"},[e("h2",{class:"section-title"},"常见问题"),e("p",{class:"section-subtitle"},"快速了解我们的服务")],-1)),e("div",be,[(n(!0),c(x,null,w(l.value,(v,m)=>(n(),c("div",{key:m,class:"faq-card"},[e("div",{class:"faq-question",onClick:u=>_(m)},[e("h3",ge,b(v.title),1),e("span",{class:T(["toggle-icon",{expanded:p.value.includes(m)}])},i[0]||(i[0]=[e("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},[e("path",{d:"M5 7.5L10 12.5L15 7.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),2)],8,me),k(V,{name:"expand"},{default:M(()=>[p.value.includes(m)?(n(),c("div",fe,[e("p",null,b(v.content||v.answer),1)])):$("",!0)]),_:2},1024)]))),128))])])]))}}),ke=L(ye,[["__scopeId","data-v-67b25a83"]]),$e={class:"about-section"},xe={class:"about-bg"},we={class:"about-cards"},Ce={class:"about-icon"},Ie=["src"],Se={class:"about-card-title"},De={class:"about-card-desc"},Ae=A({__name:"AboutSection",setup(C){const p=[{icon:"/images/about1.png",title:"大团队开发",desc:"所有商品均为团队开发，品质保障"},{icon:"/images/about2.png",title:"人工客服服务",desc:"提供完善的售后服务，购物无忧"},{icon:"/images/about3.png",title:"大平台更放心",desc:"十年开发经验，服务千万用户"},{icon:"/images/about4.png",title:"全网矩阵",desc:"覆盖全国平台，快速送达"}];return(l,_)=>(n(),c("section",$e,[e("div",xe,[_[0]||(_[0]=e("div",{class:"about-title"},"关于我们",-1)),_[1]||(_[1]=e("div",{class:"about-subtitle"},"提供高品质优质服务",-1)),e("div",we,[(n(),c(x,null,w(p,o=>e("div",{class:"about-card",key:o.title},[e("div",Ce,[e("img",{src:o.icon,alt:"icon",width:"48",height:"48"},null,8,Ie)]),e("div",Se,b(o.title),1),e("div",De,b(o.desc),1)])),64))]),_[2]||(_[2]=e("button",{class:"about-more-btn"},"查看更多 →",-1))])]))}}),Le=L(Ae,[["__scopeId","data-v-ca548900"]]),qe={class:"home-page"},Te=A({__name:"index",setup(C){bt({title:"凡图拉 - 优质商品平台",meta:[{name:"description",content:"凡图拉提供优质商品和服务，精选各类商品，确保品质与价格的完美平衡。"},{name:"keywords",content:"凡图拉,商品,购物,电商,优质商品"},{property:"og:title",content:"凡图拉 - 优质商品平台"},{property:"og:description",content:"凡图拉提供优质商品和服务，精选各类商品，确保品质与价格的完美平衡。"},{property:"og:type",content:"website"},{property:"og:url",content:"https://fantula.com"}]});const p=g([{id:1,image:"/images/banner.png",link:"",title:"凡图拉 - 优质商品平台"}]),l=g([]);return B(async()=>{try{const o=await P.getBannerList();o&&o.success&&o.data&&(p.value=o.data.map(i=>({id:i.id,image:i.img.startsWith("http")?i.img:`${window.location.origin}${i.img}`,title:i.title||"轮播图",link:""})));const d=await lt.getGoodsList({limit:100,page:1});d&&d.success&&d.data&&(l.value=d.data.list||d.data)}catch(o){console.error("首页数据获取失败:",o)}}),Q(),(o,d)=>{const i=Ct,v=_e,m=ke,u=Le,I=ut;return n(),c("div",qe,[k(dt),k(i,{banners:p.value},null,8,["banners"]),k(v,{goodsList:l.value},null,8,["goodsList"]),k(m),k(u),k(I)])}}}),He=L(Te,[["__scopeId","data-v-5e751bbb"]]);export{He as default};
