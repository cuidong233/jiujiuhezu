import{f as h,u as f,r,g as b,c as l,a as e,j as g,v as w,F as y,l as k,O as v,s as D,o as c,n as C,t as d,J as T,_ as S}from"./EcDhdyxl.js";const U={class:"exchange-section"},$={class:"exchange-container"},B={class:"exchange-input-area"},I={class:"input-wrapper"},O={class:"coupon-tabs"},V={class:"coupon-list"},F={class:"coupon-header"},L={class:"coupon-amount"},M={class:"coupon-info"},j={class:"coupon-type"},q={class:"coupon-condition"},z={class:"coupon-body"},A={class:"coupon-desc"},E={class:"coupon-footer"},G={class:"coupon-expiry"},J={class:"expiry-date"},N={key:1,class:"coupon-action expired-btn"},R=h({__name:"exchange",setup(H){f();const m=D(),n=r([]),i=r(""),a=r("all"),u=async()=>{const o=await v.get("/coupon/my/exchange");o&&o.data&&(n.value=o.data)};b(u);const x=async()=>{i.value&&(await v.post("/coupon/redeem",{code:i.value}),i.value="",u())},_=()=>a.value==="all"?n.value:a.value==="used"?n.value.filter(o=>o.isUsed):a.value==="expired"?n.value.filter(o=>new Date(o.expireTime)<new Date):n.value.filter(o=>!o.isUsed&&new Date(o.expireTime)>=new Date),p=async()=>{await m.push("/"),await T(),setTimeout(()=>{const o=document.querySelector(".goods-section");o&&o.scrollIntoView({behavior:"smooth",block:"start"})},100)};return(o,s)=>(c(),l("div",U,[s[8]||(s[8]=e("div",{class:"section-header"},[e("h2",{class:"section-title"},"兑换中心")],-1)),e("div",$,[s[6]||(s[6]=e("div",{class:"exchange-title-area"},[e("h3",{class:"exchange-title"},"兑换优惠券")],-1)),e("div",B,[e("div",I,[g(e("input",{type:"text",class:"exchange-input",placeholder:"请输入兑换码","onUpdate:modelValue":s[0]||(s[0]=t=>i.value=t)},null,512),[[w,i.value]]),e("button",{class:"exchange-btn",onClick:x},"立即兑换")]),s[5]||(s[5]=e("p",{class:"exchange-tips"},"兑换码通常由16位字母和数字组成，区分大小写",-1))])]),e("div",O,[e("div",{class:"tab-item active",onClick:s[1]||(s[1]=t=>a.value="all")},"全部优惠券"),e("div",{class:"tab-item",onClick:s[2]||(s[2]=t=>a.value="unused")},"未使用"),e("div",{class:"tab-item",onClick:s[3]||(s[3]=t=>a.value="used")},"已使用"),e("div",{class:"tab-item",onClick:s[4]||(s[4]=t=>a.value="expired")},"已过期")]),e("div",V,[(c(),l(y,null,k(_,t=>e("div",{key:t.id,class:C(["coupon-card",{available:!t.isUsed,expired:new Date(t.expireTime)<new Date}])},[e("div",F,[e("div",L,"¥"+d(t.amount),1),e("div",M,[e("div",j,d(t.name),1),e("div",q,"满¥"+d(t.minOrderAmount)+"可用",1)])]),e("div",z,[e("div",A,d(t.description),1)]),e("div",E,[e("div",G,[s[7]||(s[7]=e("span",{class:"expiry-label"},"有效期：",-1)),e("span",J,d(new Date(t.expireTime).toISOString().slice(0,10)),1)]),!t.isUsed&&new Date(t.expireTime)>=new Date?(c(),l("button",{key:0,class:"coupon-action use-btn",onClick:p},"去使用")):new Date(t.expireTime)<new Date?(c(),l("button",N,"已过期")):(c(),l("button",{key:2,class:"coupon-action use-btn",onClick:p},"已使用"))])],2)),64))])]))}}),P=S(R,[["__scopeId","data-v-3deed277"]]);export{P as default};
