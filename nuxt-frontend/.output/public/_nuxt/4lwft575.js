import{f as x,u as B,h as I,r as u,g as V,B as L,c as l,a as s,H as M,m as h,i as O,F as p,l as y,V as b,s as E,o as t,t as i,n as H,_ as R}from"./EcDhdyxl.js";import{O as T}from"./BD1EBftG.js";import"./Dw_Z4xcU.js";import"./DcjaKIUg.js";import"./CEhaGLKI.js";import"./C0puMdAJ.js";const z={class:"favorites-section"},A={key:0,class:"empty-state"},q={key:1,class:"favorites-list"},G={class:"card-header"},U=["src","alt"],j={class:"favorite-title"},J={key:0,class:"favorite-hot"},K={class:"favorite-desc"},Q={class:"favorite-params"},W={class:"favorite-param-value"},X={class:"favorite-param-value"},Y={class:"favorite-param-value"},Z={class:"favorite-param-value"},ss={class:"favorite-prices"},es=["onClick"],as={class:"price-label"},os={class:"price-value"},ts={class:"favorite-actions"},ls=["onClick"],is=["onClick"],cs=900,ns=x({__name:"favorites",setup(ds){const g=E(),k=B(),f=I(()=>{var e;return((e=k.user)==null?void 0:e.id)||1}),d=u([]),c=u({}),r=u(!1),n=u({}),_=async()=>{const e=await b.getFavorites(f.value);e&&e.data&&(d.value=e.data)};V(_);const C=(e,a)=>{c.value[e]=a},P=async e=>{await b.removeFromFavorites(f.value,e),_(),delete c.value[e]},w=()=>{r.value=!1},N=()=>{r.value=!1},D=e=>{r.value=!1},F=e=>{const a=c.value[e.id]||0,o=e.prices[a];n.value={shopLogo:e.image,shopName:e.name,shopDesc:`${o.label} - ${e.desc}`,orderId:`ORDER_${Date.now()}_${e.id}`,price:parseFloat(o.value.replace("¥","").replace(",",""))},r.value=!0},S=()=>{g.push("/")},$=()=>{d.value.forEach(e=>{e.id in c.value||(c.value[e.id]=0)})};return L(d,()=>{$()},{immediate:!0}),(e,a)=>(t(),l(p,null,[s("div",z,[a[7]||(a[7]=O('<div class="section-header" data-v-c11fe9e9><h2 class="section-title" data-v-c11fe9e9>我的收藏</h2></div><div class="favorites-tabs" data-v-c11fe9e9><div class="tab-item active" data-v-c11fe9e9>全部收藏</div><div class="tab-item" data-v-c11fe9e9>Netflix</div><div class="tab-item" data-v-c11fe9e9>Disney+</div><div class="tab-item" data-v-c11fe9e9>HBO Max</div><div class="tab-item" data-v-c11fe9e9>Apple TV+</div><div class="tab-item" data-v-c11fe9e9>Hulu</div><div class="tab-item" data-v-c11fe9e9>Prime Video</div></div>',2)),d.value.length===0?(t(),l("div",A,[a[0]||(a[0]=s("div",{class:"empty-icon"},"♡",-1)),a[1]||(a[1]=s("div",{class:"empty-text"},"暂无收藏商品",-1)),a[2]||(a[2]=s("div",{class:"empty-desc"},"去商品页面收藏喜欢的商品吧~",-1)),s("button",{class:"go-shopping-btn",onClick:S},"去逛逛")])):(t(),l("div",q,[(t(!0),l(p,null,y(d.value,o=>(t(),l("div",{class:"favorite-card",key:o.id},[s("div",G,[s("img",{src:o.image,alt:o.name,class:"favorite-logo"},null,8,U),s("span",j,i(o.name),1),o.hot?(t(),l("span",J,"热门")):h("",!0)]),s("div",K,i(o.desc),1),s("div",Q,[s("div",null,[a[3]||(a[3]=s("span",{class:"favorite-param-label"},"地区：",-1)),s("span",W,i(o.region),1)]),s("div",null,[a[4]||(a[4]=s("span",{class:"favorite-param-label"},"清晰度：",-1)),s("span",X,i(o.quality),1)]),s("div",null,[a[5]||(a[5]=s("span",{class:"favorite-param-label"},"设备数：",-1)),s("span",Y,i(o.devices),1)]),s("div",null,[a[6]||(a[6]=s("span",{class:"favorite-param-label"},"支持下载：",-1)),s("span",Z,i(o.download),1)])]),s("div",ss,[(t(!0),l(p,null,y(o.prices,(v,m)=>(t(),l("div",{class:H(["price-item",{selected:c.value[o.id]===m}]),key:v.label,onClick:rs=>C(o.id,m)},[s("span",as,i(v.label),1),s("span",os,i(v.value),1)],10,es))),128))]),s("div",ts,[s("button",{class:"buy-btn",onClick:v=>F(o)},"立即购买",8,ls),s("button",{class:"cancel-btn",onClick:v=>P(o.id)},"取消收藏",8,is)])]))),128))]))]),r.value?(t(),M(T,{key:0,shopLogo:n.value.shopLogo,shopName:n.value.shopName,shopDesc:n.value.shopDesc,orderId:n.value.orderId,price:n.value.price,countdown:cs,onClose:w,onTimeout:N,onPaySuccess:D},null,8,["shopLogo","shopName","shopDesc","orderId","price"])):h("",!0)],64))}}),hs=R(ns,[["__scopeId","data-v-c11fe9e9"]]);export{hs as default};
