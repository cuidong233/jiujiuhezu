import{f as w,u as F,h as _,r as f,g as q,c as i,b as k,a as t,F as I,l as N,t as n,d as b,E as p,s as V,x as v,o as c,j as L,y as A,m as B,_ as E}from"./EcDhdyxl.js";import{_ as M,a as S}from"./BKRz7CiX.js";import"./Dw_Z4xcU.js";const $={class:"cart-page"},D={class:"cart-main-bg"},U={class:"cart-container"},j={class:"cart-list-section"},P={class:"cart-table"},Q=["value"],R={class:"cart-goods-info"},T=["src"],z={class:"cart-goods-meta"},G={class:"cart-goods-name"},H={key:0,class:"cart-goods-spec"},J={class:"cart-price"},K={class:"cart-qty"},O=["onClick"],W=["onClick"],X={class:"cart-subtotal"},Y=["onClick"],Z={class:"cart-summary-section"},tt={class:"summary-row"},st={class:"summary-row"},et={class:"discount"},at={class:"summary-row total"},nt={class:"total-price"},ot=w({__name:"cart",setup(lt){const m=V(),u=F();_(()=>{var e;return((e=u.user)==null?void 0:e.id)||1});const o=f([]),h=f([]),d=async()=>{if(!u.isLoggedIn){p.warning("请先登录后再查看购物车"),m.push("/");return}const e=await v.getCartList();e&&e.data&&e.data.list&&(o.value=e.data.list)};q(d);const l=_(()=>!o.value||!Array.isArray(o.value)||o.value.length===0?0:o.value.reduce((e,s)=>!s||typeof s.price!="number"||typeof s.quantity!="number"?e:e+s.price*s.quantity,0)),y=_(()=>l.value>=1e3?120:l.value>=500?50:l.value>=200?20:0),g=async(e,s)=>{s<1||(await v.updateCart(e.id,s),d())},C=async e=>{await v.removeFromCart(e.id),d()},x=()=>{if(!u.isLoggedIn){p.warning("请先登录后再结算");return}if(o.value.length===0){p.warning("购物车是空的");return}m.push("/checkout")};return(e,s)=>(c(),i("div",$,[k(M),t("div",D,[t("div",U,[t("div",j,[s[2]||(s[2]=t("h2",{class:"cart-title"},"购物车",-1)),t("table",P,[s[1]||(s[1]=t("thead",null,[t("tr",null,[t("th",null,"选择"),t("th",null,"商品信息"),t("th",null,"单价"),t("th",null,"数量"),t("th",null,"小计"),t("th",null,"操作")])],-1)),t("tbody",null,[(c(!0),i(I,null,N(o.value,a=>(c(),i("tr",{key:a.id},[t("td",null,[L(t("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=r=>h.value=r),value:a.id},null,8,Q),[[A,h.value]])]),t("td",R,[t("img",{src:a.image,class:"cart-goods-img"},null,8,T),t("div",z,[t("div",G,n(a.name),1),a.skuName?(c(),i("div",H,"规格："+n(a.skuName),1)):B("",!0)])]),t("td",J,"￥"+n((a.price||0).toFixed(2)),1),t("td",K,[t("button",{onClick:r=>g(a,a.quantity-1)},"-",8,O),t("span",null,n(a.quantity),1),t("button",{onClick:r=>g(a,a.quantity+1)},"+",8,W)]),t("td",X,"￥"+n((a.price*a.quantity).toFixed(2)),1),t("td",null,[t("button",{class:"cart-remove",onClick:r=>C(a)},"删除",8,Y)])]))),128))])])]),t("div",Z,[s[6]||(s[6]=t("div",{class:"summary-title"},"订单结算",-1)),t("div",tt,[s[3]||(s[3]=t("span",null,"商品总额",-1)),t("span",null,"￥"+n(l.value.toFixed(2)),1)]),t("div",st,[s[4]||(s[4]=t("span",null,"优惠折扣",-1)),t("span",et,"-￥"+n(y.value.toFixed(2)),1)]),s[7]||(s[7]=t("div",{class:"summary-row line"},[t("span",null,"运费"),t("span",null,"￥0.00")],-1)),t("div",at,[s[5]||(s[5]=t("span",null,"应付总额",-1)),t("span",nt,"￥"+n((l.value-y.value).toFixed(2)),1)]),t("button",{class:"checkout-btn",onClick:x},"去结算 ("+n(o.value.length)+")",1),s[8]||(s[8]=t("div",{class:"cart-tips"},[t("div",null,[t("div",{class:"tips-title"},"优惠提示"),t("div",{class:"tips-content"},[b(" 满￥200减￥20｜满￥500减￥50｜满￥1000减￥120"),t("br"),b(" 满￥200减￥20｜满￥500减￥50｜满￥1000减￥120 再购￥8094.00 可享受满￥9000减￥500优惠 ")])])],-1))])])]),k(S)]))}}),ut=E(ot,[["__scopeId","data-v-e568987b"]]);export{ut as default};
