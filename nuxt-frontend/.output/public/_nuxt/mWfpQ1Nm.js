import{u as y,r as u,g as C,c as b,a as o,d as s,t as l,z as d,A as i,o as $}from"./EcDhdyxl.js";const T={style:{padding:"20px","font-family":"monospace"}},I={style:{margin:"20px 0",padding:"15px",background:"#f0f0f0","border-radius":"5px"}},w={style:{margin:"20px 0",padding:"15px",background:"#f0f0f0","border-radius":"5px"}},O={style:{margin:"20px 0",padding:"15px",background:"#f0f0f0","border-radius":"5px"}},L={style:{margin:"20px 0",padding:"15px",background:"#ffffcc","border-radius":"5px"}},N={__name:"debug",setup(U){const a=y(),g=u(""),p=u(""),k=u(""),m=u(""),n=u(""),r=()=>{const t=i("token",{httpOnly:!1,secure:!1,sameSite:"lax",maxAge:604800});g.value=t.value||"";{p.value=document.cookie,k.value=localStorage.getItem("token")||"";const e=localStorage.getItem("user");m.value=e?JSON.parse(e):null}},x=()=>{const t="test_token_"+Date.now(),e=i("token",{httpOnly:!1,secure:!1,sameSite:"lax",maxAge:60*60*24*7});e.value=t,n.value=`è®¾ç½®tokenä¸º: ${t}
`,n.value+=`ç«‹å³è¯»å–: ${e.value}
`,document.cookie=`token2=${t}; path=/; max-age=${60*60*24*7}`,n.value+=`document.cookie: ${document.cookie}`,setTimeout(r,100)},f=async()=>{n.value=`æ­£åœ¨æµ‹è¯•ç™»å½•...
`;try{const t=await $fetch("http://localhost:3002/api/auth/login",{method:"POST",body:{email:"newtest@example.com",password:"test123"}});if(t.code===0&&t.data){const e=t.data.tokenValue,c=i("token",{httpOnly:!1,secure:!1,sameSite:"lax",maxAge:60*60*24*7});c.value=e,localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(t.data)),n.value+=`âœ… ç™»å½•æˆåŠŸ
`,n.value+=`Token: ${e}
`,n.value+=`Cookieè®¾ç½®å: ${c.value}
`,a.setUser(t.data,e),setTimeout(r,100)}else n.value+=`âŒ ç™»å½•å¤±è´¥: ${t.msg}
`}catch(t){n.value+=`âŒ é”™è¯¯: ${t.message}
`}},v=()=>{window.location.reload()},S=()=>{const t=i("token");t.value=null,localStorage.clear(),document.cookie.split(";").forEach(function(e){document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+new Date().toUTCString()+";path=/")}),a.logout(),n.value="âœ… å·²æ¸…é™¤æ‰€æœ‰æ•°æ®",setTimeout(r,100)};return C(()=>{r(),n.value=`é¡µé¢åŠ è½½æ—¶çš„çŠ¶æ€ï¼š
`,n.value+=`SSR: false
`,n.value+=`Client: true
`,n.value+=`UserStore isLoggedIn: ${a.isLoggedIn}
`}),(t,e)=>($(),b("div",T,[e[11]||(e[11]=o("h1",null,"ğŸ” è°ƒè¯•é¡µé¢ - ç™»å½•çŠ¶æ€æ£€æŸ¥",-1)),o("div",I,[e[2]||(e[2]=o("h2",null,"CookieçŠ¶æ€ï¼š",-1)),o("p",null,[e[0]||(e[0]=o("strong",null,"token (useCookie):",-1)),s(" "+l(g.value||"ç©º"),1)]),o("p",null,[e[1]||(e[1]=o("strong",null,"document.cookie:",-1)),s(" "+l(p.value),1)])]),o("div",w,[e[5]||(e[5]=o("h2",null,"LocalStorageçŠ¶æ€ï¼š",-1)),o("p",null,[e[3]||(e[3]=o("strong",null,"token:",-1)),s(" "+l(k.value||"ç©º"),1)]),o("p",null,[e[4]||(e[4]=o("strong",null,"user:",-1)),s(" "+l(m.value),1)])]),o("div",O,[e[9]||(e[9]=o("h2",null,"UserStoreçŠ¶æ€ï¼š",-1)),o("p",null,[e[6]||(e[6]=o("strong",null,"isLoggedIn:",-1)),s(" "+l(d(a).isLoggedIn),1)]),o("p",null,[e[7]||(e[7]=o("strong",null,"token:",-1)),s(" "+l(d(a).token||"ç©º"),1)]),o("p",null,[e[8]||(e[8]=o("strong",null,"user:",-1)),s(" "+l(JSON.stringify(d(a).user)),1)])]),o("div",{style:{margin:"20px 0"}},[o("button",{onClick:x,style:{padding:"10px 20px","margin-right":"10px"}}," æµ‹è¯•è®¾ç½®Cookie "),o("button",{onClick:f,style:{padding:"10px 20px","margin-right":"10px"}}," æµ‹è¯•ç™»å½• "),o("button",{onClick:v,style:{padding:"10px 20px","margin-right":"10px"}}," åˆ·æ–°é¡µé¢ "),o("button",{onClick:S,style:{padding:"10px 20px"}}," æ¸…é™¤æ‰€æœ‰æ•°æ® ")]),o("div",L,[e[10]||(e[10]=o("h3",null,"æµ‹è¯•ç»“æœï¼š",-1)),o("pre",null,l(n.value),1)])]))}};export{N as default};
